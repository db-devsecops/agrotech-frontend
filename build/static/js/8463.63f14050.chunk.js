"use strict";(self.webpackChunkagrotech_frontend=self.webpackChunkagrotech_frontend||[]).push([[8463],{63730:function(e,t,r){r.d(t,{j:function(){return c}});var n=r(15671),a=r(43144),i=r(60136),o=r(29388),s=r(98248),u=r(76535),l=r(82447),h=r(35569),y=(r(59537),r(65343),r(61340),r(48916)),p={visible:"visibleSublayers"},c=function(e){(0,i.Z)(r,e);var t=(0,o.Z)(r);function r(e){var a;return(0,n.Z)(this,r),(a=t.call(this,e)).scale=0,a}return(0,a.Z)(r,[{key:"layer",set:function(e){var t=this;this._get("layer")!==e&&(this._set("layer",e),this.handles.remove("layer"),e&&this.handles.add([e.sublayers.on("change",(function(){return t.notifyChange("visibleSublayers")})),e.on("wms-sublayer-update",(function(e){return t.notifyChange(p[e.propertyName])}))],"layer"))}},{key:"layers",get:function(){return this.visibleSublayers.filter((function(e){return e.name})).map((function(e){return e.name})).join(",")}},{key:"version",get:function(){this.commitProperty("layers");var e=this.layer;return e&&e.commitProperty("imageTransparency"),(this._get("version")||0)+1}},{key:"visibleSublayers",get:function(){var e=this.layer,t=this.scale,r=null===e||void 0===e?void 0:e.sublayers,n=[];return null!==r&&void 0!==r&&r.forEach((function e(r){var a=r.minScale,i=r.maxScale,o=r.sublayers;r.visible&&(0===t||(0===a||t<=a)&&(0===i||t>=i))&&(o?o.forEach(e):n.unshift(r))})),n}},{key:"toJSON",value:function(){var e=this.layer,t=this.layers;return{format:e.imageFormat,request:"GetMap",service:"WMS",styles:"",transparent:e.imageTransparency?"TRUE":"FALSE",version:e.version,layers:t}}}]),r}((0,l.p)(u.Z));(0,s._)([(0,h.Cb)()],c.prototype,"layer",null),(0,s._)([(0,h.Cb)({readOnly:!0})],c.prototype,"layers",null),(0,s._)([(0,h.Cb)({type:Number})],c.prototype,"scale",void 0),(0,s._)([(0,h.Cb)({readOnly:!0})],c.prototype,"version",null),(0,s._)([(0,h.Cb)({readOnly:!0})],c.prototype,"visibleSublayers",null),c=(0,s._)([(0,y.j)("esri.layers.support.ExportWMSImageParameters")],c)},88463:function(e,t,r){r.r(t),r.d(t,{default:function(){return C}});var n=r(1413),a=r(15861),i=r(15671),o=r(43144),s=r(60136),u=r(29388),l=r(87757),h=r(98248),y=r(84615),p=r(71453),c=r(27970),v=r(35569),f=(r(59537),r(65343),r(61340),r(48916)),m=r(13179),d=r(86650),g=r(74605),b=r(75967),x=r(26828),w=r(35270),k=r(77284),Z=r(2798),S=r(63730),P=y.Z.getLogger("esri.views.2d.layers.WMSLayerView2D"),_=function(e){(0,s.Z)(r,e);var t=(0,u.Z)(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments)).container=new d.c,e}return(0,o.Z)(r,[{key:"supportsSpatialReference",value:function(e){return this.layer.serviceSupportsSpatialReference(e)}},{key:"update",value:function(e){this.strategy.update(e).catch((function(e){(0,p.D_)(e)||P.error(e)}))}},{key:"attach",value:function(){var e=this,t=this.layer,r=this.container,n=t.imageMaxHeight,a=t.imageMaxWidth;this.strategy=new b.Z({container:r,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxHeight:n,imageMaxWidth:a,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1}),this.handles.add((0,c.YP)((function(){return e.exportImageVersion}),(function(){return e.requestUpdate()})),"exportImageVersion")}},{key:"detach",value:function(){this.handles.remove("exportImageVersion"),this.strategy.destroy(),this.strategy=null,this.container.removeAllChildren()}},{key:"moveStart",value:function(){}},{key:"viewChange",value:function(){}},{key:"moveEnd",value:function(){this.requestUpdate()}},{key:"createFetchPopupFeaturesQuery",value:function(e){var t=this.view,r=this.container,n=e.x,a=e.y,i=t.spatialReference,o=null,s=0,u=0;if(r.children.some((function(e){var t=e.width,r=e.height,l=e.resolution,h=e.x,y=e.y,p=h+l*t,c=y-l*r;return n>=h&&n<=p&&a<=y&&a>=c&&(o=new m.Z({xmin:h,ymin:c,xmax:p,ymax:y,spatialReference:i}),s=t,u=r,!0)})),!o)return null;var l=o.width/s,h=Math.round((n-o.xmin)/l),y=Math.round((o.ymax-a)/l);return{extent:o,width:s,height:u,x:h,y:y}}},{key:"doRefresh",value:function(){var e=(0,a.Z)(l.mark((function e(){return l.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.requestUpdate();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isUpdating",value:function(){return this.strategy.updating||this.updateRequested}},{key:"fetchImage",value:function(e,t,r,a){return this.layer.fetchImage(e,t,r,(0,n.Z)({timeExtent:this.timeExtent},a))}}]),r}(function(e){var t=function(e){(0,s.Z)(r,e);var t=(0,u.Z)(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,o.Z)(r,[{key:"initialize",value:function(){this.exportImageParameters=new S.j({layer:this.layer})}},{key:"destroy",value:function(){this.exportImageParameters.destroy(),this.exportImageParameters=null}},{key:"exportImageVersion",get:function(){var e;return null!==(e=this.exportImageParameters)&&void 0!==e&&e.commitProperty("version"),this.commitProperty("timeExtent"),(this._get("exportImageVersion")||0)+1}},{key:"fetchPopupFeatures",value:function(e){var t=this.layer;if(!e)return Promise.reject(new k.Z("wmslayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:t}));var r=t.popupEnabled;if(!r)return Promise.reject(new k.Z("wmslayerview:fetchPopupFeatures","popupEnabled should be true",{popupEnabled:r}));var n=this.createFetchPopupFeaturesQuery(e);if(!n)return Promise.resolve([]);var a=n.extent,i=n.width,o=n.height,s=n.x,u=n.y;if(!(a&&i&&o))throw new k.Z("wmslayerview:fetchPopupFeatures","WMSLayer does not support fetching features.",{extent:a,width:i,height:o});var l=t.fetchFeatureInfo(a,i,o,s,u);return Promise.resolve(l?[l]:[])}}]),r}(e);return(0,h._)([(0,v.Cb)()],t.prototype,"exportImageParameters",void 0),(0,h._)([(0,v.Cb)({readOnly:!0})],t.prototype,"exportImageVersion",null),(0,h._)([(0,v.Cb)()],t.prototype,"layer",void 0),(0,h._)([(0,v.Cb)(Z.qG)],t.prototype,"timeExtent",void 0),t=(0,h._)([(0,f.j)("esri.layers.mixins.WMSLayerView")],t)}((0,w.Z)((0,g.y)(x.Z))));(0,h._)([(0,v.Cb)()],_.prototype,"strategy",void 0),(0,h._)([(0,v.Cb)()],_.prototype,"updating",void 0);var C=_=(0,h._)([(0,f.j)("esri.views.2d.layers.WMSLayerView2D")],_)}}]);